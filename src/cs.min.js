/**
 * @file
 * A DOM manipilation utility library for the version of IPB running on the
 * free forum hosting service, Jcink, that reads table information and accepts
 * a user-defined template for text replacement. Allows for the structuring
 * of forums in nontraditional, table-less layouts. Visible credits are not
 * required provided this entire comment block remains intact.
 * @author      Connor Wiseman
 * @copyright   2012-2015 Connor Wiseman
 * @version     1.5.16 (November 2015)
 * @license
 * Copyright (c) 2012-2015 Connor Wiseman
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the 'Software'), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
"use strict";var $cs=$cs||{extendModule:function(e,t){e.prototype=new t,e.prototype.constructor=e.prototype.myParent},module:{Default:function(){},Index:function(){},Stats:function(){},Profile:function(){},Topics:function(){},Posts:function(){}}};$cs.module.Default.prototype.time=!1,$cs.module.Default.prototype.html="",$cs.module.Default.prototype.values={},$cs.module.Default.prototype.getValue=function(e){var e=this.config.keyPrefix+e+this.config.keySuffix;return this.values[e]},$cs.module.Default.prototype.hasValue=function(e){var e=this.config.keyPrefix+e+this.config.keySuffix;return this.values[e]&&""!==this.values[e]},$cs.module.Default.prototype.initialize=function(e){if(e=e||{},!Object.keys(e).length)return console.error(this.name+': init method missing required argument "settings"'),!1;for(var t in e)if(-1===this.reserved.indexOf(t))if("object"==typeof e[t])for(var s in e[t])t in this&&(this[t][s]=e[t][s]);else t in this&&(this[t]=e[t]);return this.html&&""!==this.html?(this.time&&console.time(this.name),this.values={},this.execute(),this.time&&console.timeEnd(this.name),void 0):(console.error(this.name+': required property "html" is undefined'),!1)},$cs.module.Default.prototype.replaceValues=function(e,t){var s=RegExp(Object.keys(t).join("|"),"g");return e.replace(s,function(e){return t[e]})},$cs.module.Default.prototype.setValue=function(e,t){this.values[this.config.keyPrefix+e+this.config.keySuffix]=t},$cs.extendModule($cs.module.Index,$cs.module.Default),$cs.module.Index.prototype.config={target:"board",keyPrefix:"{{",keySuffix:"}}",insertBefore:"",insertAfter:"",viewingDefault:"0",subforumSeparator:", ",subforumsNone:"",moderatorsNone:"",dateDefault:"--",titleDefault:"----",urlDefault:"#",authorDefault:"",passwordTitle:"Protected Forum"},$cs.module.Index.prototype.name="$cs.module.Index",$cs.module.Index.prototype.reserved=["values","makeLink","execute","getValue","hasValue","initialize","readTable","replaceValues","setValue"],$cs.module.Index.prototype.execute=function(){var e=document.getElementById(this.config.container),t=document.getElementById("subforum-list"),s=(e||document).getElementsByClassName("category");if(s.length)for(var i=0;i<s.length;i++){var a=s[i].lastChild.previousSibling,n=a.firstElementChild;this.readTable(n,i)}else if(t){var n=t.firstElementChild;this.readTable(n,0)}},$cs.module.Index.prototype.initialize=function(e){$cs.module.Default.prototype.initialize.call(this,e)},$cs.module.Index.prototype.makeLink=function(e){return"<a href='"+e+"'>"+e.innerHTML+"</a>"},$cs.module.Index.prototype.readTable=function(e,t){var s=e.getElementsByTagName("tr");e.style.display="none";var i="";this.config.insertBefore&&""!==this.config.insertBefore&&(i+='<div class="new-category-before">'+this.config.insertBefore+"</div>");for(var a=1,n=s.length-1;n>a;a++){var l=s[a].getElementsByTagName("td");this.setValue("forumMarker",l[0].innerHTML),this.setValue("forumTitle",l[1].firstElementChild.innerHTML);var o=l[1].getElementsByClassName("x-viewing-forum")[0];o?this.setValue("forumViewing",o.innerHTML.split("(")[1].split(" Vi")[0]):this.setValue("forumViewing",this.config.viewingDefault),this.setValue("forumId",this.values["{{forumTitle}}"].split("showforum=")[1].split('" alt="')[0]),this.setValue("forumDescription",l[1].getElementsByClassName("forum-desc")[0].innerHTML);var r=l[1].getElementsByClassName("subforums")[0],u="";if(r){for(var h=r.getElementsByTagName("a"),c=1,m=h.length;m>c;c+=2){var p=this.makeLink(h[c]);u+=c===m-1?p:p+this.config.subforumSeparator}this.setValue("subforums",u)}else this.setValue("subforums",this.config.subforumsNone);var d=l[1].getElementsByClassName("forum-led-by")[0];d&&d.textContent?(this.setValue("moderators",d.innerHTML.split("Forum Led by:  ")[1]),this.setValue("redirectHits",0)):d?this.setValue("redirectHits",0):(this.setValue("moderators",this.config.moderatorsNone),this.setValue("redirectHits",l[4].textContent.split("Redirected Hits: ")[1])),this.setValue("topicCount",l[2].textContent),this.setValue("replyCount",l[3].textContent);var f=l[4],g=f.getElementsByTagName("a");g.length>0?(this.setValue("lastPostDate",f.childNodes[0].nodeValue),-1===f.textContent.indexOf("Protected Forum")?(this.setValue("lastPostTitle",this.makeLink(g[1])),this.setValue("lastPostURL",g[1].href.slice(0,-16)),g[2]?this.setValue("lastPostAuthor",this.makeLink(g[2])):this.setValue("lastPostAuthor",f.textContent.split("By: ")[1])):(this.setValue("lastPostTitle",this.config.passwordTitle),this.setValue("lastPostURL",this.config.urlDefault),this.setValue("lastPostAuthor",this.makeLink(g[0])))):(this.setValue("lastPostDate",this.config.dateDefault),this.setValue("lastPostTitle",this.config.titleDefault),this.setValue("lastPostURL",this.config.urlDefault),this.setValue("lastPostAuthor",this.config.authorDefault));var V="";-1!==this.values["{{forumMarker}}"].indexOf("<a ")&&(V=" has-new-posts"),i+='<div id="row-'+this.values["{{forumId}}"]+'" class="new-row'+V+'">'+this.replaceValues("function"==typeof this.html?this.html():this.html,this.values)+"</div>"}this.config.insertAfter&&""!==this.config.insertAfter&&(i+='<div class="new-category-after">'+this.config.insertAfter+"</div>");var y=document.createElement("div");y.innerHTML=i,y.id="category-"+(t+1),y.className="new-category",e.parentNode.appendChild(y),e.parentNode.removeChild(e)},$cs.extendModule($cs.module.Stats,$cs.module.Default),$cs.module.Stats.prototype.config={keyPrefix:"{{",keySuffix:"}}"},$cs.module.Stats.prototype.name="$cs.module.Stats",$cs.module.Stats.prototype.reserved=["values","execute","getValue","hasValue","initialize","replaceValues","setValue"],$cs.module.Stats.prototype.execute=function(){var e=document.getElementById("boardstats");if(e){var t=e.lastElementChild;t.style.display="none";for(var s=t.getElementsByTagName("td"),i=0,a=s.length;a>i;i+=3)switch(!0){case-1!==s[i].textContent.indexOf("active in the past"):this.setValue("totalUsers",s[i].textContent.split(" user")[0]);var n=s[i+2].getElementsByTagName("b");this.setValue("totalUsersGuests",n[0].textContent),this.setValue("totalUsersRegistered",n[1].textContent),this.setValue("totalUsersAnonymous",n[2].textContent);var l=s[i+2].getElementsByClassName("thin")[0];this.setValue("onlineList",l.innerHTML.split("<br><br>")[0]),this.setValue("onlineLegend",l.innerHTML.split("<br><br>")[1]),this.setValue("activityLinkClick",'<a href="/?act=Online&amp;CODE=listall&amp;sort_key=click">Last Click</a>'),this.setValue("activityLinkMemberName",'<a href="?act=Online&amp;CODE=listall&amp;sort_key=name&amp;sort_order=asc&amp;show_mem=reg">Member Name</a>');break;case"Today's"===s[i].textContent.slice(0,7):var o=s[i+2].getElementsByTagName("b");o.length>1?(this.setValue("birthdays",o[0].textContent),this.setValue("birthdaysList",s[i+2].innerHTML.split("<br />")[1])):(this.setValue("birthdays","0"),this.setValue("birthdaysList",s[i+2].textContent));break;case"Forthcoming"===s[i].textContent.slice(0,11):this.setValue("events",s[i+2].innerHTML);break;case"Board"===s[i].textContent.slice(0,5):var r=s[i+2].getElementsByTagName("b");this.setValue("totalPosts",r[0].textContent),this.setValue("totalMembers",r[1].textContent),this.setValue("newestMember",r[2].innerHTML),this.setValue("mostOnline",r[3].textContent),this.setValue("mostOnlineDate",r[4].textContent);break;case"Members"===s[i].textContent.slice(0,7):this.setValue("onlineToday",s[i].textContent.split(": ")[1].split(" [")[0]),this.setValue("onlineTodayList",s[i+2].innerHTML.split(":</span><br>")[1]);var u=s[i+2].getElementsByTagName("b");this.setValue("mostOnlineOneDay",u[0].textContent),this.setValue("mostOnlineDateOneDay",u[1].textContent);break;case"IBStore"===s[i].textContent.slice(0,7):var h=s[i+2].getElementsByTagName("b");this.setValue("storeProducts",h[0].textContent),this.setValue("storeValue",h[1].textContent),this.setValue("moneyTotal",h[2].textContent),this.setValue("moneyBanked",h[3].textContent),this.setValue("moneyCirculating",h[4].textContent),this.setValue("richestMember",h[5].innerHTML),this.setValue("richestMemberValue",h[6].textContent)}var c=document.createElement("div");c.innerHTML=this.replaceValues("function"==typeof this.html?this.html():this.html,this.values),c.id="new-statistics",t.parentNode.appendChild(c),t.parentNode.removeChild(t)}},$cs.module.Stats.prototype.initialize=function(e){$cs.module.Default.prototype.initialize.call(this,e)},$cs.extendModule($cs.module.Profile,$cs.module.Default),$cs.module.Profile.prototype.config={htmlEnabled:!1,keyPrefix:"{{",keySuffix:"}}",emailDefault:"Click here",messageDefault:"Click here",reputationIncrease:"+",reputationDecrease:"-",warnIncrease:"+",warnDecrease:"-",reputationDetails:"[details >>]",avatarDefault:"",userPhotoDefault:"",onlineActivityDefault:""},$cs.module.Profile.prototype.name="$cs.module.Profile",$cs.module.Profile.prototype.reserved=["values","execute","getValue","hasValue","initialize","replaceValues","setValue","stringToMarkup"],$cs.module.Profile.prototype.execute=function(){var e=document.getElementById("profile-heading"),t=document.getElementById("profilename");if(e){var s=e.parentNode.parentNode.parentNode.parentNode,i=document.getElementById("profile-personalinfo"),a=document.getElementById("profile-customfields"),n=document.getElementById("profile-statistics"),l=document.getElementById("profile-contactinfo"),o=document.getElementById("sig_popup"),r=document.getElementById("profile-header");s.style.display="none";var u=location.href.split("?showuser=")[1];this.setValue("userId",u);var h=i.getElementsByTagName("div"),c=h[2].getElementsByTagName("img")[0];c?this.setValue("userPhoto",c.src):this.setValue("userPhoto",this.config.userPhotoDefault);var m=h[4].textContent.split("%")[0];""!==m&&(this.setValue("warnLevel",m),this.setValue("warnLevelIncrease",'<a href="/?act=warn&type=add&mid='+u+'">'+this.config.warnIncrease+"</a>"),this.setValue("warnLevelDecrease",'<a href="/?act=warn&type=minus&mid='+u+'">'+this.config.warnDecrease+"</a>"));var p=0;if("Options"!==h[5].textContent){p=1;var d=h[5].textContent.split("] ")[1].split(" pts")[0];""!==d&&(this.setValue("reputationTotal",d),this.setValue("reputationIncrease",'<a href="/?act=rep&CODE=01&mid='+u+'&t=p">'+this.config.reputationIncrease+"</a>"),this.setValue("reputationDecrease",'<a href="/?act=rep&CODE=02&mid='+u+'&t=p">'+this.config.reputationDecrease+"</a>"),this.setValue("reputationDetails",'<a href="/?act=rep&CODE=03&mid='+u+'">'+this.config.reputationDetails+"</a>"))}this.setValue("userTitle",h[10+p].textContent),this.setValue("location",h[12+p].textContent.split("Location: ")[1]),this.setValue("birthday",h[13+p].textContent.split("Born: ")[1]),this.setValue("homePage",h[14+p].innerHTML.split("Website: ")[1]),this.config.htmlEnabled?this.setValue("interests",this.stringToMarkup(h[16+p].innerHTML)):this.setValue("interests",h[16+p].innerHTML);for(var f=a.getElementsByTagName("div"),g=1,V=f.length;V>g;g++)this.setValue("customField"+g,f[g].textContent.split(": ")[1]);var y=n.getElementsByTagName("div");this.setValue("joinDate",y[1].textContent.split("Joined: ")[1]),this.setValue("onlineStatus",y[2].textContent.split("(")[1].split(")")[0]),-1===y[2].textContent.split("(")[1].split(")")[0].indexOf("Offline")?this.setValue("onlineActivity",y[2].textContent.split(") (")[1].split(")")[0]):this.setValue("onlineActivity",this.config.onlineActivityDefault),this.setValue("lastActivity",y[3].textContent.split(": ")[1]),this.setValue("localTime",y[4].textContent.split(": ")[1]),this.setValue("postCount",y[5].textContent.split("posts")[0]),this.setValue("postsPerDay",y[5].textContent.split("(")[1].split(" per")[0]);var v=l.getElementsByTagName("div");this.setValue("userAIM",v[1].textContent),this.setValue("userYahoo",v[2].textContent),this.setValue("userGtalk",v[3].textContent),this.setValue("userMSN",v[4].textContent),this.setValue("userSkype",v[5].textContent),-1!==v[6].textContent.indexOf("Click")?this.setValue("sendMessage",'<a href="/?act=Msg&amp;CODE=00&amp;MID='+u+'">'+this.config.messageDefault+"</a>"):this.setValue("sendMessage","Private"),-1!==v[7].textContent.indexOf("Click")?this.setValue("sendEmail",'<a href="/?act=Mail&amp;CODE=00&amp;MID='+u+'">'+this.config.emailDefault+"</a>"):this.setValue("sendEmail","Private");var C=o.getElementsByTagName("td");this.setValue("signature",C[2].innerHTML);var x=r.getElementsByTagName("h3");this.setValue("userName",x[0].textContent);var T=r.getElementsByTagName("strong");this.setValue("userGroup",T[0].textContent);var E=r.previousElementSibling.getElementsByTagName("img")[0];E?this.setValue("avatar",E.src):this.setValue("avatar",this.config.avatarDefault);var D=document.createElement("div");D.innerHTML=this.replaceValues("function"==typeof this.html?this.html():this.html,this.values),D.id="new-profile",s.parentNode.appendChild(D),s.parentNode.removeChild(s)}else if(t){var N=t.parentNode.parentNode.parentNode.parentNode,M=N.nextElementSibling,w=M.nextElementSibling,L=w.nextElementSibling,b=L.nextElementSibling;N.style.display="none",M.style.display="none",w.style.display="none",L.style.display="none",b.style.display="none";var u=location.href.split("?showuser=")[1];this.setValue("userId",u);var B=N.getElementsByTagName("td"),c=B[0].getElementsByTagName("img")[0],k=B[1].getElementsByTagName("div");c?this.setValue("userPhoto",c.src):this.setValue("userPhoto",this.config.userPhotoDefault),this.setValue("userName",k[0].textContent);var $=w.getElementsByTagName("table"),P=$[0],H=$[1],I=$[2],O=$[3],S=P.getElementsByTagName("td");this.setValue("postCount",S[2].textContent.split("(")[0]),this.setValue("postsPerDay",S[4].textContent),this.setValue("joinDate",S[6].textContent),this.setValue("localTime",S[8].textContent);var A=S[10].textContent;this.setValue("onlineStatus",A.split("(")[1].split(")")[0]),-1===A.split("(")[1].split(")")[0].indexOf("Offline")?this.setValue("onlineActivity",A.split(") (")[1].split(")")[0]):this.setValue("onlineActivity",this.config.onlineActivityDefault);var z=H.getElementsByTagName("td");-1!==z[2].textContent.indexOf("Click")?this.setValue("sendEmail",'<a href="/?act=Mail&amp;CODE=00&amp;MID='+u+'">Click here</a>'):this.setValue("sendEmail","Private"),this.setValue("userSkype",z[4].textContent),this.setValue("userAIM",z[6].textContent),this.setValue("userGtalk",z[8].textContent),this.setValue("userYahoo",z[10].textContent),this.setValue("userMSN",z[12].textContent),-1!==z[14].textContent.indexOf("Click")?this.setValue("sendMessage",'<a href="/?act=Msg&amp;CODE=00&amp;MID='+u+'">Click here</a>'):this.setValue("sendMessage","Private");var R=I.getElementsByTagName("td");this.setValue("homePage",R[2].innerHTML),this.setValue("birthday",R[4].textContent),this.setValue("location",R[6].textContent),this.config.htmlEnabled?this.setValue("interests",this.stringToMarkup(R[8].innerHTML)):this.setValue("interests",R[8].innerHTML);var F=0;-1!==R[9].textContent.indexOf("Awards")&&(F=2,this.setValue("awards",R[10].innerHTML)),this.setValue("lastActivity",R[12+F].textContent);for(var g=14+F,U=1;g<R.length;g+=2,U++)this.setValue("customField"+U,R[g].textContent);var j=O.getElementsByTagName("td");this.setValue("userGroup",j[2].textContent),this.setValue("userTitle",j[4].textContent);var E=j[6].getElementsByTagName("img")[0];E?this.setValue("avatar",E.src):this.setValue("avatar",this.config.avatarDefault);for(var g=7;g<j.length;g++)switch(!0){case"Rep:"===j[g].textContent:var q=j[g+1].textContent;-1!==q.indexOf("pts")?this.setValue("reputationTotal",q.split("pts [")[0]):this.setValue("reputationTotal","0"),this.setValue("reputationIncrease",'<a href="/?act=rep&CODE=01&mid='+u+'&t=p">'+this.config.reputationIncrease+"</a>"),this.setValue("reputationDecrease",'<a href="/?act=rep&CODE=02&mid='+u+'&t=p">'+this.config.reputationDecrease+"</a>"),this.setValue("reputationDetails",'<a href="/?act=rep&CODE=03&mid='+u+'">'+this.config.reputationDetails+"</a>");break;case"Warn Level"===j[g].textContent:this.setValue("warnLevel",j[g+1].textContent.split("%")[0]),this.setValue("warnLevelIncrease",'<a href="/?act=warn&type=add&mid='+u+'">'+this.config.warnIncrease+"</a>"),this.setValue("warnLevelDecrease",'<a href="/?act=warn&type=minus&mid='+u+'">'+this.config.warnDecrease+"</a>")}var G=L.getElementsByTagName("td");this.setValue("signature",G[2].innerHTML);var D=document.createElement("div");D.innerHTML=this.replaceValues("function"==typeof this.html?this.html():this.html,this.values),D.id="new-profile",N.parentNode.appendChild(D),N.parentNode.removeChild(N),M.parentNode.removeChild(M),w.parentNode.removeChild(w),L.parentNode.removeChild(L),b.parentNode.removeChild(b)}},$cs.module.Profile.prototype.initialize=function(e){$cs.module.Default.prototype.initialize.call(this,e)},$cs.module.Profile.prototype.stringToMarkup=function(e){var t=document.createElement("div");t.innerHTML=e;for(var s="",i=0,a=t.childNodes.length;a>i;i++)t.childNodes[i].nodeValue&&(s+=t.childNodes[i].nodeValue);return t="",s},$cs.extendModule($cs.module.Topics,$cs.module.Default),$cs.module.Topics.prototype.config={keyPrefix:"{{",keySuffix:"}}",announcementsDefault:"Announcements",pinnedDefault:"Important Topics",regularDefault:"Forum Topics",noTopics:"No topics were found. This is either because there are no topics in this forum, or the topics are older than the current age cut-off.",noActiveTopics:"There were no active topics during those date ranges",paginationDefault:""},$cs.module.Topics.prototype.name="$cs.module.Topics",$cs.module.Topics.prototype.reserved=["values","execute","getValue","hasValue","initialize","replaceValues","setValue"],$cs.module.Topics.prototype.execute=function(){var e=document.getElementById("topic-list");if(!e&&window.location.href.indexOf("act=Search&CODE=getactive")>-1){for(var t=document.getElementsByTagName("form"),s=0;s<t.length;s++)t[s].action.indexOf("act=Search&CODE=getactive")>-1&&(e=t[s].nextElementSibling.nextElementSibling);var i=!0}if(e){for(var a=e.getElementsByTagName("table")[0],n=[],l="",o=" regular-topic",r=0;r<a.firstElementChild.childNodes.length;r++)1===a.firstElementChild.childNodes[r].nodeType&&"TR"===a.firstElementChild.childNodes[r].tagName&&n.push(a.firstElementChild.childNodes[r]);for(var s=1,u=n.length;u>s;s++){var h=n[s].getElementsByTagName("td");if(h[3]){if(i){this.setValue("folder",h[0].innerHTML),this.setValue("marker",h[1].innerHTML);var c=h[2].getElementsByTagName("a");if(-1===c[0].href.indexOf("view=getnewpost"))var m=c[0];else var m=c[1];this.setValue("topicId",m.getAttribute("href").split("showtopic=")[1].split("&")[0]),this.setValue("topicTitle",'<a href="'+m+'">'+m.textContent+"</a>");var p=h[2].getElementsByTagName("span");-1!==p[0].textContent.indexOf("(Pages ")?(this.setValue("pagination",p[0].innerHTML),this.setValue("topicDescription",p[1].textContent)):(this.setValue("pagination",this.config.paginationDefault),this.setValue("topicDescription",p[0].textContent)),this.setValue("parentForum",h[5].innerHTML),this.setValue("topicAuthor",h[6].innerHTML),this.setValue("replyCount",h[7].textContent),this.setValue("viewCount",h[8].textContent),this.setValue("lastReplyDate",h[9].firstChild.nodeValue),this.setValue("lastReplyDate",h[9].firstChild.nodeValue);var d=h[9].getElementsByTagName("b");d[1]?this.setValue("lastReplyAuthor",d[1].innerHTML):this.setValue("lastReplyAuthor",d[0].innerHTML),this.setValue("moderatorCheckbox","")}else{this.setValue("folder",h[0].innerHTML),this.setValue("marker",h[1].innerHTML);var m=h[2].getElementsByTagName("a")[0];m.getAttribute("title")||(m=h[2].getElementsByTagName("a")[1]),this.setValue("topicId",m.getAttribute("href").split("showtopic=")[1]),this.setValue("topicTitle",'<a href="'+m+'">'+m.textContent+"</a>");var p=h[2].getElementsByTagName("span");-1!==p[0].textContent.indexOf("(Pages ")?(this.setValue("pagination",p[0].innerHTML),this.setValue("topicDescription",p[1].textContent)):(this.setValue("pagination",this.config.paginationDefault),this.setValue("topicDescription",p[0].textContent));var f=e.firstElementChild.textContent.trim(),g='<a href="'+window.location.href+'">'+f+"</a>";this.setValue("parentForum",g),this.setValue("topicAuthor",h[3].innerHTML),this.setValue("replyCount",h[4].textContent),this.setValue("viewCount",h[5].textContent),this.setValue("lastReplyDate",h[6].getElementsByTagName("span")[0].firstChild.nodeValue),this.setValue("lastReplyAuthor",h[6].getElementsByTagName("b")[0].innerHTML),this.setValue("moderatorCheckbox",h[7].innerHTML)}l+='<div class="topic-row'+o+'">'+this.replaceValues("function"==typeof this.html?this.html():this.html,this.values)+"</div>"}else if(s===u-1||i)l+=i?'<div class="no-topics">'+this.config.noActiveTopics+"</div>":'<div class="no-topics">'+this.config.noTopics+"</div>";else{var V=h[2].getElementsByTagName("b")[0].textContent;switch(V){case"Announcements":o=" announcement-topic",l+='<div class="topic-title-row">'+this.config.announcementsDefault+"</div>";break;case"Important Topics":o=" pinned-topic",l+='<div class="topic-title-row">'+this.config.pinnedDefault+"</div>";break;default:o=" regular-topic",l+='<div class="topic-title-row">'+this.config.regularDefault+"</div>"}}}var y=document.createElement("div");y.id="new-topics",y.innerHTML=l,a.parentNode.insertBefore(y,a),i&&e.removeChild(e.lastElementChild)}},$cs.module.Topics.prototype.initialize=function(e){$cs.module.Default.prototype.initialize.call(this,e)},$cs.extendModule($cs.module.Posts,$cs.module.Default),$cs.module.Posts.prototype.config={keyPrefix:"{{",keySuffix:"}}",permaLinkDefault:"Permalink",postSignatureDefault:""},$cs.module.Posts.prototype.name="$cs.module.Posts",$cs.module.Posts.prototype.reserved=["values","execute","getValue","hasValue","initialize","replaceValues","setValue"],$cs.module.Posts.prototype.queryString=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var s=RegExp("[\\?&]"+t+"=([^&#]*)"),i=s.exec(e);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))},$cs.module.Posts.prototype.execute=function(){if(-1!==window.location.href.indexOf("showtopic")||-1!==window.location.href.indexOf("ST")){var e=document.getElementsByClassName("post-normal"),t=document.createElement("div");t.id="new-posts";for(var s=0,i=e.length;i>s;s++){e[s].style.display="none";for(var a=e[s].firstElementChild,n=a.getElementsByTagName("tr"),l=[],o=0,r=n.length;r>o;o++)for(var u=n[o].childNodes,h=0,c=u.length;c>h;h++){var m=u[h];1===m.nodeType&&"TD"===m.tagName&&m.parentNode.parentNode.parentNode===a&&l.push(m)}var p,d=l[0].getElementsByTagName("a"),f=d[0].name.split("entry")[1];p=-1!==window.location.search.indexOf("showtopic")?this.queryString(window.location.search,"showtopic"):this.queryString(window.location.search,"t"),this.setValue("postId",f),d.length>1?this.setValue("postAuthor",l[0].innerHTML.split('normalname">')[1].slice(0,-7)):this.setValue("postAuthor",l[0].innerHTML.split('unreg">')[1].slice(0,-7)),this.setValue("permaLink",'<a href="/?showtopic='+p+"&amp;view=findpost&amp;p="+f+'">'+this.config.permaLinkDefault+"</a>"),this.setValue("postDate",l[1].firstElementChild.textContent.split("Posted: ")[1]),this.setValue("postButtonsTop",l[1].lastElementChild.innerHTML);var g=0;-1!==l[2].innerHTML.indexOf("input")?(this.setValue("postCheckbox",l[2].innerHTML),g=1):this.setValue("postCheckbox",""),this.setValue("postMiniprofile",l[2+g].firstElementChild.innerHTML),this.setValue("postContent",l[3+g].firstElementChild.innerHTML);var V=l[3+g].lastElementChild;V.previousElementSibling?this.setValue("postSignature",V.innerHTML):this.setValue("postSignature",this.config.postSignatureDefault),this.setValue("postIp",l[4+g].textContent),this.setValue("postButtonsBottom",l[5+g].firstElementChild.innerHTML);var y=document.createElement("div");y.id="entry"+f,y.innerHTML=this.replaceValues("function"==typeof this.html?this.html():this.html,this.values),t.appendChild(y)}e[0].parentNode.insertBefore(t,e[0]),a.parentNode.removeChild(a)}},$cs.module.Posts.prototype.initialize=function(e){$cs.module.Default.prototype.initialize.call(this,e)};var customIndex=new $cs.module.Index,customStats=new $cs.module.Stats,customProfile=new $cs.module.Profile,customTopics=new $cs.module.Topics,customPosts=new $cs.module.Posts;