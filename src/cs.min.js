/**
 * @file
 * A DOM manipilation utility library for the version of IPB running on the
 * free forum hosting service, Jcink, that reads table information and accepts
 * a user-defined template for text replacement. Allows for the structuring
 * of forums in nontraditional, table-less layouts. Visible credits are not
 * required provided this entire comment block remains intact.
 * @author      Connor Wiseman
 * @copyright   2012-2015 Connor Wiseman
 * @version     1.6.1 (November 2015)
 * @license
 * Copyright (c) 2012-2015 Connor Wiseman
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the 'Software'), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
"use strict";var $cs=$cs||{extendModule:function(e,t){e.prototype=new t,e.prototype.constructor=e.prototype.myParent},module:{Default:function(){},Index:function(){},Stats:function(){},Profile:function(){},Topics:function(){},Posts:function(){}}};$cs.module.Default.prototype.time=!1,$cs.module.Default.prototype.html="",$cs.module.Default.prototype.values={},$cs.module.Default.prototype.getValue=function(e){var e=this.config.keyPrefix+e+this.config.keySuffix;return this.values[e]},$cs.module.Default.prototype.hasValue=function(e){var e=this.config.keyPrefix+e+this.config.keySuffix;return this.values[e]&&""!==this.values[e]},$cs.module.Default.prototype.initialize=function(e){if(e=e||{},!Object.keys(e).length)return console.error(this.name+': init method missing required argument "settings"'),!1;for(var t in e)if(-1===this.reserved.indexOf(t))if("object"==typeof e[t])for(var s in e[t])t in this&&(this[t][s]=e[t][s]);else t in this&&(this[t]=e[t]);return this.html&&""!==this.html?(this.time&&console.time(this.name),this.values={},this.execute(),this.time&&console.timeEnd(this.name),void 0):(console.error(this.name+': required property "html" is undefined'),!1)},$cs.module.Default.prototype.replaceValues=function(e,t){e="function"==typeof e?e.call(this):e;var s=RegExp(Object.keys(t).join("|"),"g");return e.replace(s,function(e){return t[e]})},$cs.module.Default.prototype.setValue=function(e,t){this.values[this.config.keyPrefix+e+this.config.keySuffix]=t},$cs.extendModule($cs.module.Index,$cs.module.Default),$cs.module.Index.prototype.config={target:"board",keyPrefix:"{{",keySuffix:"}}",insertBefore:"",insertAfter:"",viewingDefault:"0",subforumSeparator:", ",subforumsNone:"",moderatorsNone:"",dateDefault:"--",titleDefault:"----",urlDefault:"#",authorDefault:"",passwordTitle:"Protected Forum"},$cs.module.Index.prototype.name="$cs.module.Index",$cs.module.Index.prototype.reserved=["values","makeLink","execute","getValue","hasValue","initialize","readTable","replaceValues","setValue"],$cs.module.Index.prototype.execute=function(){var e=document.getElementById(this.config.container),t=document.getElementById("subforum-list"),s=(e||document).getElementsByClassName("category");if(s.length)for(var i=0;i<s.length;i++){var n=s[i].lastChild.previousSibling,a=n.firstElementChild;this.readTable(a,i)}else if(t){var a=t.firstElementChild;this.readTable(a,0)}},$cs.module.Index.prototype.initialize=function(e){$cs.module.Default.prototype.initialize.call(this,e)},$cs.module.Index.prototype.makeLink=function(e){return"<a href='"+e+"'>"+e.innerHTML+"</a>"},$cs.module.Index.prototype.readTable=function(e,t){var s=e.getElementsByTagName("tr");e.style.display="none";var i="";this.config.insertBefore&&""!==this.config.insertBefore&&(i+='<div class="new-category-before">'+this.config.insertBefore+"</div>");for(var n=1,a=s.length-1;a>n;n++){var o=s[n].getElementsByTagName("td");this.setValue("forumMarker",o[0].innerHTML),this.setValue("forumTitle",o[1].firstElementChild.innerHTML);var l=o[1].getElementsByClassName("x-viewing-forum")[0];l?this.setValue("forumViewing",l.innerHTML.split("(")[1].split(" Vi")[0]):this.setValue("forumViewing",this.config.viewingDefault),this.setValue("forumId",this.values["{{forumTitle}}"].split("showforum=")[1].split('" alt="')[0]),this.setValue("forumDescription",o[1].getElementsByClassName("forum-desc")[0].innerHTML);var r=o[1].getElementsByClassName("subforums")[0],u="";if(r){for(var c=r.getElementsByTagName("a"),h=1,d=c.length;d>h;h+=2){var p=this.makeLink(c[h]);u+=h===d-1?p:p+this.config.subforumSeparator}this.setValue("subforums",u)}else this.setValue("subforums",this.config.subforumsNone);var m=o[1].getElementsByClassName("forum-led-by")[0];m&&m.textContent?(this.setValue("moderators",m.innerHTML.split("Forum Led by:  ")[1]),this.setValue("redirectHits",0)):m?this.setValue("redirectHits",0):(this.setValue("moderators",this.config.moderatorsNone),this.setValue("redirectHits",o[4].textContent.split("Redirected Hits: ")[1])),this.setValue("topicCount",o[2].textContent),this.setValue("replyCount",o[3].textContent);var f=o[4],g=f.getElementsByTagName("a");g.length>0?(this.setValue("lastPostDate",f.childNodes[0].nodeValue),-1===f.textContent.indexOf("Protected Forum")?(this.setValue("lastPostTitle",this.makeLink(g[1])),this.setValue("lastPostURL",g[1].href.slice(0,-16)),g[2]?this.setValue("lastPostAuthor",this.makeLink(g[2])):this.setValue("lastPostAuthor",f.textContent.split("By: ")[1])):(this.setValue("lastPostTitle",this.config.passwordTitle),this.setValue("lastPostURL",this.config.urlDefault),this.setValue("lastPostAuthor",this.makeLink(g[0])))):(this.setValue("lastPostDate",this.config.dateDefault),this.setValue("lastPostTitle",this.config.titleDefault),this.setValue("lastPostURL",this.config.urlDefault),this.setValue("lastPostAuthor",this.config.authorDefault));var v="";-1!==this.values["{{forumMarker}}"].indexOf("<a ")&&(v=" has-new-posts"),i+='<div id="row-'+this.values["{{forumId}}"]+'" class="new-row'+v+'">'+this.replaceValues(this.html,this.values)+"</div>"}this.config.insertAfter&&""!==this.config.insertAfter&&(i+='<div class="new-category-after">'+this.config.insertAfter+"</div>");var y=document.createElement("div");y.innerHTML=i,y.id="category-"+(t+1),y.className="new-category",e.parentNode.appendChild(y),e.parentNode.removeChild(e)},$cs.extendModule($cs.module.Stats,$cs.module.Default),$cs.module.Stats.prototype.config={keyPrefix:"{{",keySuffix:"}}"},$cs.module.Stats.prototype.name="$cs.module.Stats",$cs.module.Stats.prototype.reserved=["values","execute","getValue","hasValue","initialize","replaceValues","setValue"],$cs.module.Stats.prototype.execute=function(){var e=document.getElementById("boardstats");if(e){var t=e.lastElementChild;t.style.display="none";for(var s=t.getElementsByTagName("td"),i=0,n=s.length;n>i;i+=3)switch(!0){case-1!==s[i].textContent.indexOf("active in the past"):this.setValue("totalUsers",s[i].textContent.split(" user")[0]);var a=s[i+2].getElementsByTagName("b");this.setValue("totalUsersGuests",a[0].textContent),this.setValue("totalUsersRegistered",a[1].textContent),this.setValue("totalUsersAnonymous",a[2].textContent);var o=s[i+2].getElementsByClassName("thin")[0];this.setValue("onlineList",o.innerHTML.split("<br><br>")[0]),this.setValue("onlineLegend",o.innerHTML.split("<br><br>")[1]),this.setValue("activityLinkClick",'<a href="/?act=Online&amp;CODE=listall&amp;sort_key=click">Last Click</a>'),this.setValue("activityLinkMemberName",'<a href="?act=Online&amp;CODE=listall&amp;sort_key=name&amp;sort_order=asc&amp;show_mem=reg">Member Name</a>');break;case"Today's"===s[i].textContent.slice(0,7):var l=s[i+2].getElementsByTagName("b");l.length>1?(this.setValue("birthdays",l[0].textContent),this.setValue("birthdaysList",s[i+2].innerHTML.split("<br />")[1])):(this.setValue("birthdays","0"),this.setValue("birthdaysList",s[i+2].textContent));break;case"Forthcoming"===s[i].textContent.slice(0,11):this.setValue("events",s[i+2].innerHTML);break;case"Board"===s[i].textContent.slice(0,5):var r=s[i+2].getElementsByTagName("b");this.setValue("totalPosts",r[0].textContent),this.setValue("totalMembers",r[1].textContent),this.setValue("newestMember",r[2].innerHTML),this.setValue("mostOnline",r[3].textContent),this.setValue("mostOnlineDate",r[4].textContent);break;case"Members"===s[i].textContent.slice(0,7):this.setValue("onlineToday",s[i].textContent.split(": ")[1].split(" [")[0]),this.setValue("onlineTodayList",s[i+2].innerHTML.split(":</span><br>")[1]);var u=s[i+2].getElementsByTagName("b");this.setValue("mostOnlineOneDay",u[0].textContent),this.setValue("mostOnlineDateOneDay",u[1].textContent);break;case"IBStore"===s[i].textContent.slice(0,7):var c=s[i+2].getElementsByTagName("b");this.setValue("storeProducts",c[0].textContent),this.setValue("storeValue",c[1].textContent),this.setValue("moneyTotal",c[2].textContent),this.setValue("moneyBanked",c[3].textContent),this.setValue("moneyCirculating",c[4].textContent),this.setValue("richestMember",c[5].innerHTML),this.setValue("richestMemberValue",c[6].textContent)}var h=document.createElement("div");h.innerHTML=this.replaceValues(this.html,this.values),h.id="new-statistics",t.parentNode.appendChild(h),t.parentNode.removeChild(t)}},$cs.module.Stats.prototype.initialize=function(e){$cs.module.Default.prototype.initialize.call(this,e)},$cs.extendModule($cs.module.Profile,$cs.module.Default),$cs.module.Profile.prototype.config={htmlEnabled:!1,keyPrefix:"{{",keySuffix:"}}",emailDefault:"Click here",messageDefault:"Click here",reputationIncrease:"+",reputationDecrease:"-",warnIncrease:"+",warnDecrease:"-",reputationDetails:"[details >>]",avatarDefault:"",userPhotoDefault:"",onlineActivityDefault:""},$cs.module.Profile.prototype.name="$cs.module.Profile",$cs.module.Profile.prototype.reserved=["values","execute","getValue","hasValue","initialize","replaceValues","setValue","stringToMarkup"],$cs.module.Profile.prototype.execute=function(){var e=document.getElementById("profile-heading"),t=document.getElementById("profilename");if(e){var s=e.parentNode.parentNode.parentNode.parentNode,i=document.getElementById("profile-personalinfo"),n=document.getElementById("profile-customfields"),a=document.getElementById("profile-statistics"),o=document.getElementById("profile-contactinfo"),l=document.getElementById("sig_popup"),r=document.getElementById("profile-header");s.style.display="none";var u=location.href.split("?showuser=")[1];this.setValue("userId",u);var c=i.getElementsByTagName("div"),h=c[2].getElementsByTagName("img")[0];h?this.setValue("userPhoto",h.src):this.setValue("userPhoto",this.config.userPhotoDefault);var d=c[4].textContent.split("%")[0];""!==d&&(this.setValue("warnLevel",d),this.setValue("warnLevelIncrease",'<a href="/?act=warn&type=add&mid='+u+'">'+this.config.warnIncrease+"</a>"),this.setValue("warnLevelDecrease",'<a href="/?act=warn&type=minus&mid='+u+'">'+this.config.warnDecrease+"</a>"));var p=0;if("Options"!==c[5].textContent){p=1;var m=c[5].textContent.split("] ")[1].split(" pts")[0];""!==m&&(this.setValue("reputationTotal",m),this.setValue("reputationIncrease",'<a href="/?act=rep&CODE=01&mid='+u+'&t=p">'+this.config.reputationIncrease+"</a>"),this.setValue("reputationDecrease",'<a href="/?act=rep&CODE=02&mid='+u+'&t=p">'+this.config.reputationDecrease+"</a>"),this.setValue("reputationDetails",'<a href="/?act=rep&CODE=03&mid='+u+'">'+this.config.reputationDetails+"</a>"))}this.setValue("userTitle",c[10+p].textContent),this.setValue("location",c[12+p].textContent.split("Location: ")[1]),this.setValue("birthday",c[13+p].textContent.split("Born: ")[1]),this.setValue("homePage",c[14+p].innerHTML.split("Website: ")[1]),this.config.htmlEnabled?this.setValue("interests",this.stringToMarkup(c[16+p].innerHTML)):this.setValue("interests",c[16+p].innerHTML);for(var f=n.getElementsByTagName("div"),g=1,v=f.length;v>g;g++)this.setValue("customField"+g,f[g].textContent.split(": ")[1]);var y=a.getElementsByTagName("div");this.setValue("joinDate",y[1].textContent.split("Joined: ")[1]),this.setValue("onlineStatus",y[2].textContent.split("(")[1].split(")")[0]),-1===y[2].textContent.split("(")[1].split(")")[0].indexOf("Offline")?this.setValue("onlineActivity",y[2].textContent.split(") (")[1].split(")")[0]):this.setValue("onlineActivity",this.config.onlineActivityDefault),this.setValue("lastActivity",y[3].textContent.split(": ")[1]),this.setValue("localTime",y[4].textContent.split(": ")[1]),this.setValue("postCount",y[5].textContent.split("posts")[0]),this.setValue("postsPerDay",y[5].textContent.split("(")[1].split(" per")[0]);var V=o.getElementsByTagName("div");this.setValue("userAIM",V[1].textContent),this.setValue("userYahoo",V[2].textContent),this.setValue("userGtalk",V[3].textContent),this.setValue("userMSN",V[4].textContent),this.setValue("userSkype",V[5].textContent),-1!==V[6].textContent.indexOf("Click")?this.setValue("sendMessage",'<a href="/?act=Msg&amp;CODE=00&amp;MID='+u+'">'+this.config.messageDefault+"</a>"):this.setValue("sendMessage","Private"),-1!==V[7].textContent.indexOf("Click")?this.setValue("sendEmail",'<a href="/?act=Mail&amp;CODE=00&amp;MID='+u+'">'+this.config.emailDefault+"</a>"):this.setValue("sendEmail","Private");var C=l.getElementsByTagName("td");this.setValue("signature",C[2].innerHTML);var x=r.getElementsByTagName("h3");this.setValue("userName",x[0].textContent);var T=r.getElementsByTagName("strong");this.setValue("userGroup",T[0].textContent);var E=r.previousElementSibling.getElementsByTagName("img")[0];E?this.setValue("avatar",E.src):this.setValue("avatar",this.config.avatarDefault);var D=document.createElement("div");D.innerHTML=this.replaceValues(this.html,this.values),D.id="new-profile",s.parentNode.appendChild(D),s.parentNode.removeChild(s)}else if(t){var N=t.parentNode.parentNode.parentNode.parentNode,M=N.nextElementSibling,L=M.nextElementSibling,k=L.nextElementSibling,b=k.nextElementSibling;N.style.display="none",M.style.display="none",L.style.display="none",k.style.display="none",b.style.display="none";var u=location.href.split("?showuser=")[1];this.setValue("userId",u);var w=N.getElementsByTagName("td"),h=w[0].getElementsByTagName("img")[0],B=w[1].getElementsByTagName("div");h?this.setValue("userPhoto",h.src):this.setValue("userPhoto",this.config.userPhotoDefault),this.setValue("userName",B[0].textContent);var P=L.getElementsByTagName("table"),H=P[0],$=P[1],O=P[2],S=P[3],I=H.getElementsByTagName("td");this.setValue("postCount",I[2].textContent.split("(")[0]),this.setValue("postsPerDay",I[4].textContent),this.setValue("joinDate",I[6].textContent),this.setValue("localTime",I[8].textContent);var A=I[10].textContent;this.setValue("onlineStatus",A.split("(")[1].split(")")[0]),-1===A.split("(")[1].split(")")[0].indexOf("Offline")?this.setValue("onlineActivity",A.split(") (")[1].split(")")[0]):this.setValue("onlineActivity",this.config.onlineActivityDefault);var R=$.getElementsByTagName("td");-1!==R[2].textContent.indexOf("Click")?this.setValue("sendEmail",'<a href="/?act=Mail&amp;CODE=00&amp;MID='+u+'">Click here</a>'):this.setValue("sendEmail","Private"),this.setValue("userSkype",R[4].textContent),this.setValue("userAIM",R[6].textContent),this.setValue("userGtalk",R[8].textContent),this.setValue("userYahoo",R[10].textContent),this.setValue("userMSN",R[12].textContent),-1!==R[14].textContent.indexOf("Click")?this.setValue("sendMessage",'<a href="/?act=Msg&amp;CODE=00&amp;MID='+u+'">Click here</a>'):this.setValue("sendMessage","Private");var q=O.getElementsByTagName("td");this.setValue("homePage",q[2].innerHTML),this.setValue("birthday",q[4].textContent),this.setValue("location",q[6].textContent),this.config.htmlEnabled?this.setValue("interests",this.stringToMarkup(q[8].innerHTML)):this.setValue("interests",q[8].innerHTML);var z=0;-1!==q[9].textContent.indexOf("Awards")&&(z=2,this.setValue("awards",q[10].innerHTML)),this.setValue("lastActivity",q[12+z].textContent);for(var g=14+z,F=1;g<q.length;g+=2,F++)this.setValue("customField"+F,q[g].textContent);var U=S.getElementsByTagName("td");this.setValue("userGroup",U[2].textContent),this.setValue("userTitle",U[4].textContent);var E=U[6].getElementsByTagName("img")[0];E?this.setValue("avatar",E.src):this.setValue("avatar",this.config.avatarDefault);for(var g=7;g<U.length;g++)switch(!0){case"Rep:"===U[g].textContent:var j=U[g+1].textContent;-1!==j.indexOf("pts")?this.setValue("reputationTotal",j.split("pts [")[0]):this.setValue("reputationTotal","0"),this.setValue("reputationIncrease",'<a href="/?act=rep&CODE=01&mid='+u+'&t=p">'+this.config.reputationIncrease+"</a>"),this.setValue("reputationDecrease",'<a href="/?act=rep&CODE=02&mid='+u+'&t=p">'+this.config.reputationDecrease+"</a>"),this.setValue("reputationDetails",'<a href="/?act=rep&CODE=03&mid='+u+'">'+this.config.reputationDetails+"</a>");break;case"Warn Level"===U[g].textContent:this.setValue("warnLevel",U[g+1].textContent.split("%")[0]),this.setValue("warnLevelIncrease",'<a href="/?act=warn&type=add&mid='+u+'">'+this.config.warnIncrease+"</a>"),this.setValue("warnLevelDecrease",'<a href="/?act=warn&type=minus&mid='+u+'">'+this.config.warnDecrease+"</a>")}var G=k.getElementsByTagName("td");this.setValue("signature",G[2].innerHTML);var D=document.createElement("div");D.innerHTML=this.replaceValues(this.html,this.values),D.id="new-profile",N.parentNode.appendChild(D),N.parentNode.removeChild(N),M.parentNode.removeChild(M),L.parentNode.removeChild(L),k.parentNode.removeChild(k),b.parentNode.removeChild(b)}},$cs.module.Profile.prototype.initialize=function(e){$cs.module.Default.prototype.initialize.call(this,e)},$cs.module.Profile.prototype.stringToMarkup=function(e){var t=document.createElement("div");t.innerHTML=e;for(var s="",i=0,n=t.childNodes.length;n>i;i++)t.childNodes[i].nodeValue&&(s+=t.childNodes[i].nodeValue);return t="",s},$cs.extendModule($cs.module.Topics,$cs.module.Default),$cs.module.Topics.prototype.config={keyPrefix:"{{",keySuffix:"}}",announcementsDefault:"Announcements",pinnedDefault:"Important Topics",regularDefault:"Forum Topics",noTopics:"No topics were found. This is either because there are no topics in this forum, or the topics are older than the current age cut-off.",noActiveTopics:"There were no active topics during those date ranges",paginationDefault:"",activeTopics:!1},$cs.module.Topics.prototype.name="$cs.module.Topics",$cs.module.Topics.prototype.reserved=["values","execute","getValue","hasValue","initialize","replaceValues","setValue"],$cs.module.Topics.prototype.execute=function(){var e=document.getElementById("topic-list");if(!e&&this.config.activeTopics&&window.location.href.indexOf("act=Search&CODE=getactive")>-1){for(var t=document.getElementsByTagName("form"),s=0;s<t.length;s++)t[s].action.indexOf("act=Search&CODE=getactive")>-1&&(e=t[s].nextElementSibling.nextElementSibling);var i=!0}if(e){for(var n=e.getElementsByTagName("table")[0],a=[],o="",l=" regular-topic",r=0;r<n.firstElementChild.childNodes.length;r++)1===n.firstElementChild.childNodes[r].nodeType&&"TR"===n.firstElementChild.childNodes[r].tagName&&a.push(n.firstElementChild.childNodes[r]);n.style.display="none";for(var s=1,u=a.length;u>s;s++){var c=a[s].getElementsByTagName("td");if(c[3]){if(i){if(this.config.activeTopics){this.setValue("folder",c[0].innerHTML),this.setValue("marker",c[1].innerHTML);var h=c[2].getElementsByTagName("a");if(-1===h[0].href.indexOf("view=getnewpost"))var d=h[0];else var d=h[1];this.setValue("topicId",d.getAttribute("href").split("showtopic=")[1].split("&")[0]),this.setValue("topicTitle",'<a href="'+d+'">'+d.textContent+"</a>");var p=c[2].getElementsByTagName("span");-1!==p[0].textContent.indexOf("(Pages ")?(this.setValue("pagination",p[0].innerHTML),this.setValue("topicDescription",p[1].textContent)):(this.setValue("pagination",this.config.paginationDefault),this.setValue("topicDescription",p[0].textContent)),this.setValue("parentForum",c[5].innerHTML),this.setValue("topicAuthor",c[6].innerHTML),this.setValue("replyCount",c[7].textContent),this.setValue("viewCount",c[8].textContent),this.setValue("lastReplyDate",c[9].firstChild.nodeValue),this.setValue("lastReplyDate",c[9].firstChild.nodeValue);var m=c[9].getElementsByTagName("b");m[1]?this.setValue("lastReplyAuthor",m[1].innerHTML):this.setValue("lastReplyAuthor",m[0].innerHTML),this.setValue("moderatorCheckbox","")}}else{this.setValue("folder",c[0].innerHTML),this.setValue("marker",c[1].innerHTML);var d=c[2].getElementsByTagName("a")[0];d.getAttribute("title")||(d=c[2].getElementsByTagName("a")[1]),this.setValue("topicId",d.getAttribute("href").split("showtopic=")[1]),this.setValue("topicTitle",'<a href="'+d+'">'+d.textContent+"</a>");var p=c[2].getElementsByTagName("span");-1!==p[0].textContent.indexOf("(Pages ")?(this.setValue("pagination",p[0].innerHTML),this.setValue("topicDescription",p[1].textContent)):(this.setValue("pagination",this.config.paginationDefault),this.setValue("topicDescription",p[0].textContent));var f=e.firstElementChild.textContent.trim(),g='<a href="'+window.location.href+'">'+f+"</a>";this.setValue("parentForum",g),this.setValue("topicAuthor",c[3].innerHTML),this.setValue("replyCount",c[4].textContent),this.setValue("viewCount",c[5].textContent),this.setValue("lastReplyDate",c[6].getElementsByTagName("span")[0].firstChild.nodeValue),this.setValue("lastReplyAuthor",c[6].getElementsByTagName("b")[0].innerHTML),this.setValue("moderatorCheckbox",c[7].innerHTML)}o+='<div class="topic-row'+l+'">'+this.replaceValues(this.html,this.values)+"</div>"}else if(s===u-1||i)i?this.config.activeTopics&&(o+='<div class="no-topics">'+this.config.noActiveTopics+"</div>"):o+='<div class="no-topics">'+this.config.noTopics+"</div>";else{var v=c[2].getElementsByTagName("b")[0].textContent;switch(v){case"Announcements":l=" announcement-topic",o+='<div class="topic-title-row">'+this.config.announcementsDefault+"</div>";break;case"Important Topics":l=" pinned-topic",o+='<div class="topic-title-row">'+this.config.pinnedDefault+"</div>";break;default:l=" regular-topic",o+='<div class="topic-title-row">'+this.config.regularDefault+"</div>"}}}var y=document.createElement("div");y.id="new-topics",y.innerHTML=o,n.parentNode.insertBefore(y,n),n.parentNode.removeChild(n),this.config.activeTopics&&i&&e.removeChild(e.lastElementChild)}},$cs.module.Topics.prototype.initialize=function(e){$cs.module.Default.prototype.initialize.call(this,e)},$cs.extendModule($cs.module.Posts,$cs.module.Default),$cs.module.Posts.prototype.config={keyPrefix:"{{",keySuffix:"}}",permaLinkDefault:"Permalink",postSignatureDefault:"",quickEdit:!1},$cs.module.Posts.prototype.name="$cs.module.Posts",$cs.module.Posts.prototype.reserved=["values","execute","getValue","hasValue","initialize","QuickEdit","replaceValues","setValue"],$cs.module.Posts.prototype.queryString=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var s=RegExp("[\\?&]"+t+"=([^&#]*)"),i=s.exec(e);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))},$cs.module.Posts.prototype.QuickEdit={makeRequest:function(e,t,s){var i=new(XMLHttpRequest||ActiveXObject)("MSXML2.XMLHTTP.3.0");i.open(s?"POST":"GET",e),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){i.readyState>3&&t&&"function"==typeof t&&t(i.responseText)},i.send(s)},filter:function(e){for(var t="",s=0;s<e.length;s++){var i=e.charCodeAt(s);t+=i>127?"&#"+i+";":e.charAt(s)}return encodeURIComponent?encodeURIComponent(t):escape(t)},EditForm:function(e,t,s,i,n,a,o){var l=document.createElement("form"),r=document.createElement("textarea"),u=document.createElement("div"),c=document.createElement("button"),h=document.createElement("button"),d=document.createElement("button");l.addEventListener("submit",function(e){e.preventDefault()});var p=document.createElement("div");p.innerHTML=n;var m=p.firstElementChild.value,f=p.lastElementChild.value;return r.innerHTML=f,r.style.boxSizing="border-box",c.innerHTML="Edit",h.innerHTML="Cancel",d.innerHTML="Full Edit",c.addEventListener("click",function(n){n.preventDefault();var a="/?act=Post&quickedit=1&CODE=09&f="+e+"&t="+t+"&p="+s+"&st="+i+"&auth_key="+m;o.makeRequest(a,function(e){var t=document.createElement("div");t.innerHTML=e;var i=t.getElementsByTagName("a");if(1!==i.length)return void console.error("Could not submit edited post via POST submission. Edit failed.");var n=i[0].href+"&nocache="+(new Date).getTime();o.makeRequest(n,function(e){var t=RegExp("<!-- THE POST "+s+" -->\n        <div class='postcolor'>((.|\n)*?)</div>\n        \n        <!-- THE POST -->");if(t=t.exec(e),!t)return void console.error("Could not GET edited post. Read failed.");var i=document.createElement("div");i.classList.add("cs-quick-edit"),i.innerHTML=t[1],c.parentNode.parentNode.parentNode.replaceChild(i,c.parentNode.parentNode)})},"Post="+o.filter(r.value))}),h.addEventListener("click",function(e){e.preventDefault(),this.parentNode.parentNode.parentNode.replaceChild(a,this.parentNode.parentNode)}),d.addEventListener("click",function(n){n.preventDefault(),window.location.href="/?act=Post&CODE=08&f="+e+"&t="+t+"&p="+s+"&st="+i}),u.appendChild(c),u.appendChild(h),u.appendChild(d),l.appendChild(r),l.appendChild(u),l}},$cs.module.Posts.prototype.execute=function(){if(-1!==window.location.href.indexOf("showtopic")||-1!==window.location.href.indexOf("ST")){var e=document.getElementsByClassName("post-normal"),t=document.createElement("div");t.id="new-posts";for(var s=0,i=e.length;i>s;s++){e[s].style.display="none";for(var n=e[s].firstElementChild,a=n.getElementsByTagName("tr"),o=[],l=0,r=a.length;r>l;l++)for(var u=a[l].childNodes,c=0,h=u.length;h>c;c++){var d=u[c];1===d.nodeType&&"TD"===d.tagName&&d.parentNode.parentNode.parentNode===n&&o.push(d)}var p,m=o[0].getElementsByTagName("a"),f=m[0].name.split("entry")[1];p=-1!==window.location.search.indexOf("showtopic")?this.queryString(window.location.search,"showtopic"):this.queryString(window.location.search,"t"),this.setValue("postId",f),m.length>1?this.setValue("postAuthor",o[0].innerHTML.split('normalname">')[1].slice(0,-7)):this.setValue("postAuthor",o[0].innerHTML.split('unreg">')[1].slice(0,-7)),this.setValue("permaLink",'<a href="/?showtopic='+p+"&amp;view=findpost&amp;p="+f+'">'+this.config.permaLinkDefault+"</a>"),this.setValue("postDate",o[1].firstElementChild.textContent.split("Posted: ")[1]),this.setValue("postButtonsTop",o[1].lastElementChild.innerHTML);var g=0;-1!==o[2].innerHTML.indexOf("input")?(this.setValue("postCheckbox",o[2].innerHTML),g=1):this.setValue("postCheckbox",""),this.setValue("postMiniprofile",o[2+g].firstElementChild.innerHTML),this.config.quickEdit?this.setValue("postContent",'<div class="cs-quick-edit">'+o[3+g].firstElementChild.innerHTML+"</div>"):this.setValue("postContent",o[3+g].firstElementChild.innerHTML);var v=o[3+g].lastElementChild;v.previousElementSibling?this.setValue("postSignature",v.innerHTML):this.setValue("postSignature",this.config.postSignatureDefault),this.setValue("postIp",o[4+g].textContent),this.setValue("postButtonsBottom",o[5+g].firstElementChild.innerHTML);var y=document.createElement("div");if(y.id="entry"+f,y.innerHTML=this.replaceValues(this.html,this.values),t.appendChild(y),this.config.quickEdit)for(var m=y.getElementsByTagName("a"),V=0;V<m.length;V++)-1!==m[V].href.indexOf("act=Post&CODE=08")&&m[V].addEventListener("click",function(e){e.preventDefault();var t=this.queryString(e.currentTarget.href,"f"),s=this.queryString(e.currentTarget.href,"t"),i=this.queryString(e.currentTarget.href,"p"),n=this.queryString(e.currentTarget.href,"st")||"0",a="/?&act=Post&CODE=08&f="+t+"&t="+s+"&p="+i+"&st="+n+"&quickedit=1",o=document.getElementById("entry"+i).getElementsByClassName("cs-quick-edit")[0];this.QuickEdit.makeRequest(a,function(e){var a=new this.EditForm(t,s,i,n,e,o,this);o.parentNode.replaceChild(a,o)}.bind(this.QuickEdit))}.bind(this))}e[0].parentNode.insertBefore(t,e[0]),n.parentNode.removeChild(n)}},$cs.module.Posts.prototype.initialize=function(e){$cs.module.Default.prototype.initialize.call(this,e)};var customIndex=new $cs.module.Index,customStats=new $cs.module.Stats,customProfile=new $cs.module.Profile,customTopics=new $cs.module.Topics,customPosts=new $cs.module.Posts;